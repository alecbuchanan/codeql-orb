description: >
  This command downloads the CodeQL CLI and sets it up for use in your project.

parameters:
  codeql_directory:
    description: The directory on the runner where the CodeQL CLI should be downloaded. This should exist outside of the project directory.
    type: string
    default: "/home/circleci/codeql"
  language_identifier:
    description: > 
        The programming language for which the CodeQL database is to be created.
        CodeQL supports [ 'c-cpp', 'csharp', 'go', 'java-kotlin', 'javascript-typescript', 'python', 'ruby', 'swift' ]
        Use only 'java-kotlin' to analyze code written in Java, Kotlin or both
        Use only 'javascript-typescript' to analyze code written in JavaScript, TypeScript or both
        Learn more about CodeQL language support at https://aka.ms/codeql-docs/language-support
    enum:
    - "c-cpp"
    - "csharp"
    - "go"
    - "java-kotlin"
    - "javascript-typescript"
    - "python"
    - "ruby"
    - "swift"

steps:
  - run:
      environment:
        CODEQL_DIR: << parameters.codeql_directory >>
        LANGUAGE_IDENTIFIER: << parameters.language_identifier >>
      name: Download CodeQL CLI and Create CodeQL Database
      command: <<include(scripts/initialize_codeql.sh)>>
